<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>복지관2층매장</title>

  <!-- 캐시 꼬임 방지(최대한) -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    :root{
      --bg:#f5f6f8;
      --card:#ffffff;
      --ink:#1f2937;
      --muted:#6b7280;
      --line:#e5e7eb;

      --price:#ef4444;
      --tab:#2563eb;

      --call:#22c55e;
      --sms:#38bdf8;
      --kakao:#fee500;
      --kakaoInk:#3b2f00;
    }

    *{box-sizing:border-box;}
    html,body{margin:0;padding:0;}
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;
      background:var(--bg);
      color:var(--ink);
      -webkit-font-smoothing:antialiased;
    }
    a{color:inherit;text-decoration:none;}
    .wrap{max-width:1100px;margin:0 auto;padding:14px 12px 22px;}

    /* 상단 간판(과하지 않게, 아침형) */
    .top{
      background:#fff;
      border:1px solid var(--line);
      border-radius:18px;
      padding:14px 14px 12px;
      box-shadow:0 6px 18px rgba(17,24,39,.06);
    }
    .brandRow{
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      align-items:flex-start;
    }
    .title{
      margin:0;
      font-size:30px;
      font-weight:1000;
      letter-spacing:-0.03em;
      line-height:1.05;
    }
    .sub{
      margin:6px 0 0;
      font-size:13px;
      font-weight:800;
      color:var(--muted);
    }

    .contacts{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-weight:1000;
      box-shadow:0 4px 12px rgba(17,24,39,.06);
      white-space:nowrap;
    }
    .chip small{color:var(--muted); font-weight:1000;}
    .chip.kakao{
      background:var(--kakao);
      border-color:#f6e05e;
      color:var(--kakaoInk);
    }

    /* 탭(6개) */
    .tabs{
      margin-top:12px;
      display:flex;
      gap:8px;
      overflow:auto;
      padding-bottom:6px;
      -webkit-overflow-scrolling:touch;
    }
    .tabBtn{
      flex:0 0 auto;
      padding:11px 14px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-weight:1000;
      font-size:14px;
      cursor:pointer;
      box-shadow:0 4px 12px rgba(17,24,39,.05);
      white-space:nowrap;
      transition:.12s ease;
    }
    .tabBtn.active{
      border-color:rgba(37,99,235,.35);
      background:rgba(37,99,235,.10);
      color:var(--tab);
      transform:translateY(-1px);
    }

    .sectionHead{
      margin-top:12px;
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }
    .sectionTitle{
      margin:0;
      font-size:18px;
      font-weight:1000;
      letter-spacing:-0.03em;
    }
    .sectionHint{
      margin:0;
      font-size:12px;
      font-weight:900;
      color:var(--muted);
    }

    .grid{
      margin-top:10px;
      display:grid;
      gap:10px;
      grid-template-columns:repeat(2, minmax(0, 1fr));
    }
    @media (min-width:760px){
      .grid{grid-template-columns:repeat(3, minmax(0, 1fr)); gap:12px;}
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      padding:12px;
      box-shadow:0 10px 22px rgba(17,24,39,.06);
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height:140px;
    }

    /* 휴대폰: 모델/판매가 최대 */
    .model{margin:0; font-size:22px; font-weight:1000; letter-spacing:-0.03em; line-height:1.08; word-break:keep-all;}
    .price{margin:0; font-size:28px; font-weight:1000; letter-spacing:-0.04em; line-height:1.05; color:var(--price); word-break:keep-all;}
    .subPrice{margin:0; font-size:14px; font-weight:900; color:var(--muted);}

    /* 인터넷TV: 지원금+상품권 최대 */
    .tvMain{margin:0; font-size:30px; font-weight:1000; letter-spacing:-0.04em; color:var(--price); line-height:1.05;}
    .tvGift{margin:0; font-size:20px; font-weight:1000; letter-spacing:-0.03em; color:#0f172a;}

    /* 알뜰: 요금(3,300원) 최대 */
    .mvnoFee{margin:0; font-size:34px; font-weight:1000; letter-spacing:-0.05em; color:var(--price); line-height:1.0;}
    .mvnoDesc{margin:0; font-size:14px; font-weight:900; color:var(--muted);}

    .note{margin:0; font-size:12px; font-weight:900; color:var(--muted); line-height:1.3; word-break:keep-all;}

    .tags{display:flex; flex-wrap:wrap; gap:6px; margin-top:auto;}
    .tag{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-size:12px;
      font-weight:1000;
      color:#0f172a;
      letter-spacing:-0.02em;
    }
    .tag.blue{border-color:rgba(37,99,235,.25); background:rgba(37,99,235,.08); color:var(--tab);}
    .tag.gray{color:var(--muted);}

    .empty{
      border:1px dashed #cbd5e1;
      background:linear-gradient(180deg,#ffffff,#f8fafc);
    }
    .empty .price,.empty .tvMain,.empty .mvnoFee{color:#94a3b8;}
    .empty .model{color:#334155;}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brandRow">
        <div>
          <h1 class="title">복지관2층매장</h1>
          <p class="sub">휴대폰 특가 · 인터넷TV · 알뜰요금제 실시간 안내</p>
        </div>
        <div class="contacts">
          <a class="chip" href="tel:042-821-2272"><small>전화</small><span>042-821-2272</span></a>
          <a class="chip" href="sms:010-5839-1512"><small>문자</small><span>010-5839-1512</span></a>
          <a class="chip kakao" href="https://open.kakao.com/o/s729bI5h" target="_blank" rel="noopener"><small>카톡</small><span>오픈채팅</span></a>
        </div>
      </div>

      <div class="tabs" id="tabs">
        <button class="tabBtn active" data-key="PHONE_SK">SK 특가폰</button>
        <button class="tabBtn" data-key="PHONE_KT">KT 특가폰</button>
        <button class="tabBtn" data-key="PHONE_LG">LG 특가폰</button>
        <button class="tabBtn" data-key="INTERNET_TV">인터넷TV</button>
        <button class="tabBtn" data-key="MVNO">알뜰요금제</button>
        <button class="tabBtn" data-key="ETC">공지/기타</button>
      </div>
    </div>

    <div class="sectionHead">
      <h2 class="sectionTitle" id="sectionTitle">SK 특가폰</h2>
      <p class="sectionHint" id="sectionHint">SK 109요금 6개월 / 부가별도문의</p>
    </div>

    <div class="grid" id="grid"></div>
  </div>

<script>
  const META = {
    PHONE_SK: { title:'SK 특가폰', hint:'SK 109요금 6개월 / 부가별도문의' },
    PHONE_KT: { title:'KT 특가폰', hint:'KT 110요금 6개월 / 부가별도문의' },
    PHONE_LG: { title:'LG 특가폰', hint:'LG 115요금 6개월 / 부가별도문의' },
    INTERNET_TV: { title:'인터넷TV', hint:'지원금 + 상품권 (조건 문의)' },
    MVNO: { title:'알뜰요금제', hint:'요금(예: 3,300원~) 크게 표시' },
    ETC: { title:'공지/기타', hint:'공지/서비스/안내' }
  };

  let activeKey = 'PHONE_SK';
  let rows = [];

  const $grid = document.getElementById('grid');
  const $sectionTitle = document.getElementById('sectionTitle');
  const $sectionHint = document.getElementById('sectionHint');

  function esc(s=''){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }
  function splitCSVLine(line){
    const res=[]; let cur=''; let inQ=false;
    for(let i=0;i<line.length;i++){
      const ch=line[i];
      if(ch === '"'){
        if(inQ && line[i+1] === '"'){ cur+='"'; i++; }
        else inQ=!inQ;
      } else if(ch === ',' && !inQ){ res.push(cur); cur=''; }
      else cur+=ch;
    }
    res.push(cur);
    return res;
  }
  function parseCSV(text){
    const lines=text.replace(/\r/g,'').split('\n').filter(l=>l.trim().length);
    if(!lines.length) return [];
    const header=splitCSVLine(lines[0]).map(h=>h.trim());
    const out=[];
    for(let i=1;i<lines.length;i++){
      const cols=splitCSVLine(lines[i]);
      const obj={};
      header.forEach((h,idx)=>obj[h]=(cols[idx]??'').trim());
      if(obj.type || obj.title || obj.display_price) out.push(obj);
    }
    return out;
  }
  function filtered(){ return rows.filter(r => (r.type||'').toUpperCase() === activeKey); }

  function phoneHint(key){
    if(key==='PHONE_SK') return 'SK 109요금 6개월';
    if(key==='PHONE_KT') return 'KT 110요금 6개월';
    return 'LG 115요금 6개월';
  }

  function cardPhone(r){
    const model=esc(r.title||'특판 등록 예정');
    const price=esc(r.display_price||'가격 등록 예정');
    const sub=esc(r.sub_price||'요금조건 문의');
    const note=esc(r.note||'');
    const empty = (!r.title && !r.display_price) ? 'empty' : '';
    return `
      <div class="card ${empty}">
        <p class="model">${model}</p>
        <p class="price">${price}</p>
        <p class="subPrice">${sub}</p>
        ${note ? `<p class="note">${note}</p>` : ''}
        <div class="tags">
          <span class="tag blue">${phoneHint(activeKey)}</span>
          <span class="tag gray">부가별도문의</span>
        </div>
      </div>`;
  }

  function cardTV(r){
    const title=esc(r.title||'인터넷TV 등록 예정');
    const main=esc(r.display_price||'지원금 등록 예정');
    const gift=esc(r.sub_price||'상품권 등록 예정');
    const note=esc(r.note||'설치/약정/결합 조건 문의');
    const empty = (!r.title && !r.display_price && !r.sub_price) ? 'empty' : '';
    return `
      <div class="card ${empty}">
        <p class="model">${title}</p>
        <p class="tvMain">${main}</p>
        <p class="tvGift">${gift}</p>
        <p class="note">${note}</p>
        <div class="tags">
          <span class="tag blue">지원금 + 상품권</span>
          <span class="tag gray">조건 문의</span>
        </div>
      </div>`;
  }

  function cardMVNO(r){
    const title=esc(r.title||'알뜰요금제 등록 예정');
    const fee=esc(r.display_price||'3,300원~');
    const desc=esc(r.sub_price||'요금제 상세 조건');
    const note=esc(r.note||'가입비/유심 등 추가비용 문의');
    const empty = (!r.title && !r.display_price && !r.sub_price) ? 'empty' : '';
    return `
      <div class="card ${empty}">
        <p class="model">${title}</p>
        <p class="mvnoFee">${fee}</p>
        <p class="mvnoDesc">${desc}</p>
        <p class="note">${note}</p>
        <div class="tags">
          <span class="tag blue">알뜰요금</span>
          <span class="tag gray">문의</span>
        </div>
      </div>`;
  }

  function cardETC(r){
    const title=esc(r.title||'공지/서비스 등록 예정');
    const main=esc(r.display_price||'내용 등록 예정');
    const sub=esc(r.sub_price||'');
    const note=esc(r.note||'');
    const empty = (!r.title && !r.display_price && !r.sub_price && !r.note) ? 'empty' : '';
    return `
      <div class="card ${empty}">
        <p class="model">${title}</p>
        <p class="price" style="color:#0f172a">${main}</p>
        ${sub ? `<p class="subPrice">${sub}</p>` : ''}
        ${note ? `<p class="note">${note}</p>` : ''}
        <div class="tags">
          <span class="tag blue">안내</span>
          <span class="tag gray">공지</span>
        </div>
      </div>`;
  }

  function render(){
    const meta = META[activeKey] || META.PHONE_SK;
    $sectionTitle.textContent = meta.title;
    $sectionHint.textContent = meta.hint;

    const list = filtered();
    const show = list.length ? list : Array.from({length:6}, ()=>({}));

    let html='';
    if(activeKey==='PHONE_SK' || activeKey==='PHONE_KT' || activeKey==='PHONE_LG'){
      html = show.map(cardPhone).join('');
    } else if(activeKey==='INTERNET_TV'){
      html = show.map(cardTV).join('');
    } else if(activeKey==='MVNO'){
      html = show.map(cardMVNO).join('');
    } else {
      html = show.map(cardETC).join('');
    }
    $grid.innerHTML = html;
  }

  async function loadCSV(){
    try{
      const res = await fetch('data.csv', { cache:'no-store' });
      if(!res.ok) throw new Error('no csv');
      rows = parseCSV(await res.text());
    } catch(e){
      rows = [];
    }
  }

  document.querySelectorAll('#tabs .tabBtn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const key = btn.getAttribute('data-key');
      if(!key) return;
      activeKey = key;
      document.querySelectorAll('#tabs .tabBtn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      render();
      setTimeout(()=>window.scrollTo({top: document.querySelector('.sectionHead').offsetTop - 8, behavior:'smooth'}), 30);
    });
  });

  (async ()=>{
    await loadCSV();
    render();
  })();
</script>

</body>
</html>
