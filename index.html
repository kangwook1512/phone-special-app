<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>복지관2층매장</title>

<style>
:root{
  --bg:#f5f6f8;
  --card:#ffffff;
  --ink:#1f2937;
  --muted:#6b7280;
  --line:#e5e7eb;
  --price:#ef4444;
  --tab:#2563eb;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;
  background:var(--bg);
  color:var(--ink);
}

/* 상단 탭 */
.tabs{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  padding:12px;
  background:#fff;
  border-bottom:1px solid var(--line);
}
.tab{
  padding:14px 0;
  text-align:center;
  font-weight:900;
  border-radius:12px;
  background:#f3f4f6;
  cursor:pointer;
}
.tab.active{
  background:var(--tab);
  color:#fff;
}

/* 카드 */
.main{padding:12px 12px 160px;}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.card{
  background:var(--card);
  border-radius:18px;
  padding:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
}
.model{font-size:17px;font-weight:900;margin-bottom:6px;}
.price{font-size:28px;font-weight:900;color:var(--price);margin-bottom:6px;}
.sub{font-size:13px;color:var(--muted);font-weight:700;}
.note{font-size:13px;font-weight:800;margin-top:4px;}
</style>
</head>

<body>

<!-- 탭 (상품군 기준) -->
<div class="tabs">
  <div class="tab active" data-tab="SK_PHONE">SK휴대폰</div>
  <div class="tab" data-tab="KT_PHONE">KT휴대폰</div>
  <div class="tab" data-tab="LG_PHONE">LG휴대폰</div>

  <div class="tab" data-tab="SPECIAL">특가폰</div>
  <div class="tab" data-tab="INTV">인터넷TV</div>
  <div class="tab" data-tab="MVNO">알뜰요금</div>
</div>

<div class="main">
  <div class="grid" id="cards"></div>
</div>

<script>
const CSV_URL = 'data.csv?v=' + Date.now();
const grid = document.getElementById('cards');
const tabs = document.querySelectorAll('.tab');

function parseCSV(text){
  const lines = text.trim().split('\n');
  const headers = lines.shift().split(',');
  return lines.map(l=>{
    const c=l.split(',');
    const o={};
    headers.forEach((h,i)=>o[h]=c[i]||'');
    return o;
  });
}

function filterRows(rows, tab){
  switch(tab){
    case 'SK_PHONE': return rows.filter(r=>r.type==='PHONE' && r.carrier==='SK');
    case 'KT_PHONE': return rows.filter(r=>r.type==='PHONE' && r.carrier==='KT');
    case 'LG_PHONE': return rows.filter(r=>r.type==='PHONE' && r.carrier==='LG');
    case 'SPECIAL': return rows.filter(r=>r.type==='SPECIAL');
    case 'INTV': return rows.filter(r=>r.type==='INTV');
    case 'MVNO': return rows.filter(r=>r.type==='MVNO');
  }
  return [];
}

function cardHTML(r){
  return `
  <div class="card">
    <div class="model">${r.title}</div>
    <div class="price">${r.display_price}</div>
    ${r.note ? `<div class="note">${r.note}</div>` : ''}
  </div>`;
}

function render(tab){
  fetch(CSV_URL,{cache:'no-store'})
    .then(r=>r.text())
    .then(t=>{
      const rows=parseCSV(t);
      const show=filterRows(rows,tab);
      grid.innerHTML = show.length
        ? show.map(cardHTML).join('')
        : `<div class="card" style="grid-column:1/-1">표시할 항목 없음</div>`;
    });
}

tabs.forEach(t=>{
  t.onclick=()=>{
    tabs.forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    render(t.dataset.tab);
  };
});

render('SK_PHONE');
</script>

</body>
</html>
