<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ë³µì§€ê´€2ì¸µë§¤ì¥</title>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations().then(rs=>rs.forEach(r=>r.unregister()));
}
</script>

<style>
:root{
  --bg:#f5f6f8; --card:#fff; --ink:#111827; --muted:#6b7280; --line:#e5e7eb;
  --price:#ef4444; --tab:#2563eb; --call:#22c55e; --sms:#38bdf8; --kakao:#fee500;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;background:var(--bg);color:var(--ink)}

/* ë„¤ì˜¨ ë°°ë„ˆ */
.neon-banner{
  margin:12px;padding:16px 14px;background:linear-gradient(135deg,#fff200,#ffe066);
  border-radius:16px;border:2px solid #fff6a3;
  box-shadow:0 0 8px rgba(255,242,0,.9),0 0 18px rgba(255,242,0,.7),0 0 32px rgba(255,242,0,.5);
  pointer-events:none
}
.neon-title{font-size:18px;font-weight:1000;text-align:center}
.neon-points{margin-top:10px;display:grid;gap:6px}
.neon-point{font-size:15px;font-weight:900;text-align:center}
.neon-point b{text-decoration:underline}

/* íƒ­ */
.tabs{
  display:flex;gap:6px;padding:10px 8px;background:#fff;
  border-bottom:1px solid var(--line);
  overflow-x:auto;white-space:nowrap
}
.tab{
  flex:1 1 0;min-width:0;padding:12px 0;
  font-size:14px;font-weight:900;text-align:center;
  border-radius:12px;background:#f3f4f6;cursor:pointer
}
.tab.active{background:var(--tab);color:#fff}

/* ì¹´ë“œ */
.main{padding:12px;padding-bottom:190px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.card{background:var(--card);border-radius:18px;padding:16px;box-shadow:0 4px 12px rgba(0,0,0,.05)}
.badge{font-size:12px;font-weight:900;color:#2563eb;margin-bottom:6px}
.model{font-size:16px;font-weight:900;margin-bottom:6px}
.price{font-size:26px;font-weight:900;color:var(--price)}
.sub{font-size:13px;font-weight:700;margin-top:6px}

/* íœ´ëŒ€í° ê°•ì¡° */
.card.phone .model{font-size:clamp(18px,4.8vw,26px)}
.card.phone .price{font-size:clamp(30px,7.2vw,44px)}
.card.phone .sub{color:var(--ink)}

/* ì¤€ë¹„ì¤‘ */
.card--soon{opacity:.5;filter:grayscale(1);pointer-events:none}
.soonIcon{
  display:inline-flex;width:24px;height:24px;
  border-radius:50%;border:1px solid #ccc;
  align-items:center;justify-content:center
}

/* í•˜ë‹¨ */
.footer{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--line)}
.footer-msg{text-align:center;padding:10px;font-weight:900}
.footer-store{text-align:center;font-size:18px;font-weight:900}
.footer-actions{display:grid;grid-template-columns:1fr 1fr 1fr}
.footer-actions a{padding:16px 0;text-align:center;font-weight:900;text-decoration:none;color:#111}
.call{background:var(--call);color:#fff}
.sms{background:var(--sms);color:#fff}
.kakao{background:var(--kakao)}
</style>
</head>

<body>

<div class="neon-banner">
  <div class="neon-title">ì¸í„°ë„·TVÂ·ì•Œëœ°ìš”ê¸ˆì€ ì¹´í†¡ë¬¸ì˜</div>
  <div class="neon-points">
    <div class="neon-point">ğŸ’° ì¸í„°ë„·TV <b>í˜„ê¸ˆ ìµœëŒ€</b></div>
    <div class="neon-point">ğŸ”¥ ì•Œëœ°ìš”ê¸ˆ <b>3,300ì›~</b></div>
  </div>
</div>

<div class="tabs">
  <div class="tab active" data-tab="SK_PHONE">SK</div>
  <div class="tab" data-tab="KT_PHONE">KT</div>
  <div class="tab" data-tab="LG_PHONE">LG</div>
  <div class="tab" data-tab="HOT_DEAL">í•«ë”œ</div>
  <div class="tab" data-tab="LOW_PHONE">ì €ê°€</div>
</div>

<div class="main"><div class="grid" id="cards"></div></div>

<div class="footer">
  <div class="footer-msg">ì•¡ì •í•„ë¦„ ë¬´ë£Œêµì²´ (ì¹´í†¡ì£¼ë¬¸í•„ìˆ˜)</div>
  <div class="footer-store">ë³µì§€ê´€2ì¸µë§¤ì¥</div>
  <div class="footer-actions">
    <a class="call" href="tel:042-821-2272">ì „í™”</a>
    <a class="sms" href="sms:010-5839-1512">ë¬¸ì</a>
    <a class="kakao" href="https://open.kakao.com/o/s729bI5h" target="_blank">ì¹´í†¡</a>
  </div>
</div>

<script>
const CSV_URL='data.csv?v='+Date.now();
const grid=document.getElementById('cards');
const tabs=document.querySelectorAll('.tab');

function parseCSV(t){
  t=(t||'').replace(/\r/g,'');
  const rows=[], cur=[]; let cell='', q=false;
  for(let i=0;i<t.length;i++){
    const c=t[i], n=t[i+1];
    if(c=='"'&&n=='"'){cell+='"';i++}
    else if(c=='"'){q=!q}
    else if(c==','&&!q){cur.push(cell);cell=''}
    else if(c=='\n'&&!q){cur.push(cell);rows.push([...cur]);cur.length=0;cell=''}
    else cell+=c
  }
  cur.push(cell); rows.push([...cur]);
  const h=rows.shift().map(x=>x.trim());
  return rows.filter(r=>r.some(v=>v.trim())).map(r=>{
    const o={}; h.forEach((k,i)=>o[k]=(r[i]||'').trim()); return o;
  });
}

const isHot=r=>/(-\s*\d+)|(\b0\b)/.test(r.display_price||'');

function phoneCards(r){
  const out=[];
  const m=r.display_price.match(/ì´ë™\s*([-\d]+)/);
  const g=r.display_price.match(/ê¸°ë³€\s*([-\d]+)/);
  if(m) out.push(card('ì´ë™',r.title,m[1]));
  if(g) out.push(card('ê¸°ë³€',r.title,g[1]));
  return out;
}
const card=(b,t,p)=>`
<div class="card phone">
  <div class="badge">${b}</div>
  <div class="model">${t}</div>
  <div class="price">${p}ë§Œì›</div>
  <div class="sub">ë¶€ê°€ë³„ë„ë¬¸ì˜</div>
</div>`;

function render(tab){
  fetch(CSV_URL).then(r=>r.text()).then(t=>{
    const rows=parseCSV(t);

    /* âœ… í•µì‹¬: íƒ­ ì „í™˜ ì‹œ í•­ìƒ ì´ˆê¸°í™” */
    grid.innerHTML='';

    if(tab==='HOT_DEAL'){
      rows.filter(r=>r.type==='PHONE'&&isHot(r))
        .sort((a,b)=>{
          const av=Math.min(...(a.display_price.match(/-?\d+/g)||[]).map(Number));
          const bv=Math.min(...(b.display_price.match(/-?\d+/g)||[]).map(Number));
          return av-bv;
        })
        .forEach(r=>phoneCards(r).forEach(h=>grid.innerHTML+=h));
      return;
    }

    if(tab==='LOW_PHONE'){
      const lows=rows.filter(r=>r.type==='PHONE_LOW');
      lows.forEach(r=>grid.innerHTML+=card('ì €ê°€',r.title,r.display_price));
      for(let i=lows.length;i<6;i++){
        grid.innerHTML+=`
          <div class="card card--soon">
            <div class="model"><span class="soonIcon">â³</span> ì¤€ë¹„ì¤‘</div>
            <div class="sub">ê³§ ì¶”ê°€ë©ë‹ˆë‹¤</div>
          </div>`;
      }
      return;
    }

    rows.filter(r=>r.type==='PHONE'&&r.carrier===tab.split('_')[0]&&!isHot(r))
      .forEach(r=>phoneCards(r).forEach(h=>grid.innerHTML+=h));
  });
}

tabs.forEach(t=>{
  t.onclick=()=>{
    tabs.forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    render(t.dataset.tab);
  };
});
render('SK_PHONE');
</script>

</body>
</html>
