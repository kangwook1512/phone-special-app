<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ë³µì§€ê´€2ì¸µë§¤ì¥</title>

<!-- ğŸ”¥ ì„œë¹„ìŠ¤ì›Œì»¤ ì™„ì „ ì œê±° (ìºì‹œ ë¬¸ì œ ì¢…ê²°) -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations().then(regs=>{
    regs.forEach(r=>r.unregister());
  });
}
</script>

<style>
:root{
  --bg:#f5f6f8;
  --card:#ffffff;
  --ink:#111827;
  --muted:#6b7280;
  --line:#e5e7eb;
  --price:#ef4444;
  --tab:#2563eb;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;
}
.tabs{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  padding:12px;
  background:#fff;
  border-bottom:1px solid var(--line);
}
.tab{
  padding:14px 0;
  text-align:center;
  font-weight:900;
  border-radius:12px;
  background:#f3f4f6;
  cursor:pointer;
}
.tab.active{background:var(--tab);color:#fff}

.main{padding:12px 12px 160px}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.card{
  background:var(--card);
  border-radius:16px;
  padding:16px;
  box-shadow:0 4px 10px rgba(0,0,0,.05);
}
.model{font-size:16px;font-weight:900;margin-bottom:6px}
.price{font-size:26px;font-weight:900;color:var(--price)}
.sub{font-size:13px;color:var(--muted);font-weight:700;margin-top:4px}
.badge{font-size:12px;font-weight:900;color:#2563eb;margin-bottom:4px}
</style>
</head>

<body>

<!-- âœ… ìƒí’ˆêµ° ê¸°ì¤€ íƒ­ -->
<div class="tabs">
  <div class="tab active" data-tab="SK_PHONE">SKíœ´ëŒ€í°</div>
  <div class="tab" data-tab="KT_PHONE">KTíœ´ëŒ€í°</div>
  <div class="tab" data-tab="LG_PHONE">LGíœ´ëŒ€í°</div>
  <div class="tab" data-tab="SPECIAL">íŠ¹ê°€í°</div>
  <div class="tab" data-tab="INTV">ì¸í„°ë„·TV</div>
  <div class="tab" data-tab="MVNO">ì•Œëœ°ìš”ê¸ˆ</div>
</div>

<div class="main">
  <div class="grid" id="cards"></div>
</div>

<script>
const CSV_URL = 'data.csv?v=' + Date.now();
const grid = document.getElementById('cards');
const tabs = document.querySelectorAll('.tab');

/* âœ… ì•ˆì „í•œ CSV íŒŒì„œ (ì½¤ë§ˆ/í•œê¸€/ê´„í˜¸ OK) */
function parseCSV(text){
  const rows=[], cur=[];
  let cell='', inQ=false;
  for(let i=0;i<text.length;i++){
    const c=text[i], n=text[i+1];
    if(c=='"'&&n=='"'){cell+='"';i++}
    else if(c=='"'){inQ=!inQ}
    else if(c==','&&!inQ){cur.push(cell);cell=''}
    else if(c=='\n'&&!inQ){cur.push(cell);rows.push([...cur]);cur.length=0;cell=''}
    else cell+=c;
  }
  cur.push(cell); rows.push([...cur]);
  const header=rows.shift();
  return rows.map(r=>{
    const o={};
    header.forEach((h,i)=>o[h]=r[i]||'');
    return o;
  });
}

/* íœ´ëŒ€í° ì´ë™/ê¸°ë³€ ë¶„ë¦¬ */
function phoneCards(r){
  const out=[];
  const m=r.display_price.match(/ì´ë™\s*([-\d]+)/);
  const g=r.display_price.match(/ê¸°ë³€\s*([-\d]+)/);
  if(m) out.push(card(r.title,'ì´ë™',m[1]));
  if(g) out.push(card(r.title,'ê¸°ë³€',g[1]));
  return out;
}

function card(title,badge,price,sub=''){
  return `
  <div class="card">
    ${badge?`<div class="badge">${badge}</div>`:''}
    <div class="model">${title}</div>
    <div class="price">${price}ë§Œì›</div>
    ${sub?`<div class="sub">${sub}</div>`:''}
  </div>`;
}

function render(tab){
  fetch(CSV_URL,{cache:'no-store'})
    .then(r=>r.text())
    .then(t=>{
      const rows=parseCSV(t);
      let show=[];

      if(tab==='SK_PHONE') show=rows.filter(r=>r.type==='PHONE'&&r.carrier==='SK');
      if(tab==='KT_PHONE') show=rows.filter(r=>r.type==='PHONE'&&r.carrier==='KT');
      if(tab==='LG_PHONE') show=rows.filter(r=>r.type==='PHONE'&&r.carrier==='LG');
      if(tab==='SPECIAL')  show=rows.filter(r=>r.type==='SPECIAL');
      if(tab==='INTV')     show=rows.filter(r=>r.type==='INTV');
      if(tab==='MVNO')     show=rows.filter(r=>r.type==='MVNO');

      grid.innerHTML='';
      show.forEach(r=>{
        if(r.type==='PHONE') phoneCards(r).forEach(c=>grid.innerHTML+=c);
        else grid.innerHTML+=card(r.title,'',r.display_price,r.note);
      });

      if(!grid.innerHTML)
        grid.innerHTML='<div class="card" style="grid-column:1/-1">í‘œì‹œí•  í•­ëª© ì—†ìŒ</div>';
    });
}

tabs.forEach(t=>{
  t.onclick=()=>{
    tabs.forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    render(t.dataset.tab);
  };
});

render('SK_PHONE');
</script>

</body>
</html>
