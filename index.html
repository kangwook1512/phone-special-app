<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ë³µì§€ê´€2ì¸µë§¤ì¥</title>

<!-- ì„œë¹„ìŠ¤ì›Œì»¤ ì™„ì „ ë¬´ë ¥í™” -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations().then(regs=>{
    regs.forEach(r=>r.unregister());
  });
}
</script>

<style>
:root{
  --bg:#f5f6f8;
  --card:#ffffff;
  --ink:#111827;
  --muted:#6b7280;
  --line:#e5e7eb;

  --price:#ef4444;
  --tab:#2563eb;

  --call:#22c55e;
  --sms:#38bdf8;
  --kakao:#fee500;
}

*{box-sizing:border-box;}
html,body{margin:0;padding:0;}
body{
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;
  background:var(--bg);
  color:var(--ink);
}

/* ===============================
   ğŸ”¥ ë„¤ì˜¨ ê´‘ê³ ë°°ë„ˆ (ìµœìƒë‹¨)
================================ */
.neon-banner{
  margin:12px;
  padding:16px 14px;
  background:linear-gradient(135deg,#fff200,#ffe066);
  border-radius:16px;
  border:2px solid #fff6a3;
  box-shadow:
    0 0 8px rgba(255,242,0,.9),
    0 0 18px rgba(255,242,0,.7),
    0 0 32px rgba(255,242,0,.5);
  pointer-events:none; /* í´ë¦­ ì™„ì „ ì°¨ë‹¨ */
}
.neon-title{
  font-size:18px;
  font-weight:1000;
  text-align:center;
  letter-spacing:-0.02em;
}
.neon-points{
  margin-top:10px;
  display:grid;
  gap:6px;
}
.neon-point{
  font-size:15px;
  font-weight:900;
  text-align:center;
}
.neon-point b{
  font-weight:1000;
  text-decoration:underline;
  text-underline-offset:3px;
}

/* ===============================
   íƒ­ (SK / KT / LG / ì €ê°€ìš”ê¸ˆí°)
================================ */
.tabs{
  display:flex;
  gap:8px;
  padding:12px;
  background:#fff;
  border-bottom:1px solid var(--line);
}
.tab{
  flex:1;
  padding:14px 0;
  text-align:center;
  font-weight:900;
  border-radius:12px;
  background:#f3f4f6;
  cursor:pointer;
  user-select:none;
}
.tab.active{
  background:var(--tab);
  color:#fff;
}

/* ì¹´ë“œ */
.main{padding:12px;padding-bottom:190px;}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.card{
  background:var(--card);
  border-radius:18px;
  padding:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
}
.badge{font-size:12px;font-weight:900;color:#2563eb;margin-bottom:6px;}
.model{font-size:16px;font-weight:900;margin-bottom:6px;line-height:1.15;}
.price{font-size:26px;font-weight:900;color:var(--price);line-height:1.05;}
.sub{font-size:13px;color:var(--muted);font-weight:700;margin-top:6px;line-height:1.25;}

/* íœ´ëŒ€í° ê°•ì¡° */
.card.phone .model{
  font-size: clamp(18px, 4.8vw, 26px);
  font-weight: 900;
  margin-bottom: 10px;
}
.card.phone .price{
  font-size: clamp(30px, 7.2vw, 44px);
  font-weight: 900;
  margin-bottom: 8px;
}
.card.phone .sub{
  font-size: 13px;
  font-weight: 800;
  color: var(--ink);
  margin-top: 6px;
}

/* âœ… ì¤€ë¹„ì¤‘ ì¹´ë“œ */
.card--soon{
  opacity:.55;
  filter:grayscale(1);
  pointer-events:none;
}
.card--soon .model{
  display:flex;
  align-items:center;
  gap:8px;
}
.card--soon .soonIcon{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:26px;
  height:26px;
  border-radius:999px;
  border:1px solid #d1d5db;
  background:#fff;
  font-size:16px;
  line-height:1;
}

/* âœ… ì €ê°€ìš”ê¸ˆí° ê°€ê²© ê°€ë…ì„±(íƒ­ LOW ì „ìš©) */
.lowPrice{ display:grid; gap:6px; }
.lowLine{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
}
.lowLabel{ font-weight:900; opacity:.95; }
.lowNum{ font-weight:1000; letter-spacing:-0.02em; }
.lowSuffix{ font-weight:900; }

/* í•˜ë‹¨ */
.footer{
  position:fixed;left:0;right:0;bottom:0;
  background:#fff;border-top:1px solid var(--line);
}
.footer-msg{text-align:center;padding:10px;font-size:14px;font-weight:900;}
.footer-store{text-align:center;font-size:18px;font-weight:900;padding-bottom:6px;}
.footer-actions{display:grid;grid-template-columns:1fr 1fr 1fr;}
.footer-actions a{
  text-align:center;padding:16px 0;
  font-weight:900;text-decoration:none;color:#111;
}
.call{background:var(--call);color:#fff;}
.sms{background:var(--sms);color:#fff;}
.kakao{background:var(--kakao);}
</style>
</head>

<body>

<!-- ğŸ”¥ ë„¤ì˜¨ ê´‘ê³ íŒ -->
<div class="neon-banner">
  <div class="neon-title">ì¸í„°ë„·TVÂ·ì•Œëœ°ìš”ê¸ˆì€ ì¹´í†¡ë¬¸ì˜</div>
  <div class="neon-points">
    <div class="neon-point">ğŸ’° ì¸í„°ë„·TV : <b>í˜„ê¸ˆ ìµœëŒ€ ì§€ì›</b></div>
    <div class="neon-point">ğŸ”¥ ì•Œëœ°ìš”ê¸ˆ : <b>ìµœì €ìš”ê¸ˆ 3,300ì›~</b></div>
  </div>
</div>

<!-- SK / KT / LG / ì €ê°€ìš”ê¸ˆí° -->
<div class="tabs">
  <div class="tab active" data-tab="SK_PHONE">SKíœ´ëŒ€í°</div>
  <div class="tab" data-tab="KT_PHONE">KTíœ´ëŒ€í°</div>
  <div class="tab" data-tab="LG_PHONE">LGíœ´ëŒ€í°</div>
  <div class="tab" data-tab="LOW_PHONE">ì €ê°€ìš”ê¸ˆí°</div>
</div>

<!-- ì¹´ë“œ -->
<div class="main">
  <div class="grid" id="cards"></div>
</div>

<!-- í•˜ë‹¨ -->
<div class="footer">
  <div class="footer-msg">ì•¡ì •í•„ë¦„ ë¬´ë£Œêµì²´ (ì¹´í†¡ì£¼ë¬¸í•„ìˆ˜)</div>
  <div class="footer-store">ë³µì§€ê´€2ì¸µë§¤ì¥</div>
  <div class="footer-actions">
    <a class="call" href="tel:042-821-2272">ì „í™”</a>
    <a class="sms" href="sms:010-5839-1512">ë¬¸ì</a>
    <a class="kakao" href="https://open.kakao.com/o/s729bI5h" target="_blank" rel="noopener">ì¹´í†¡</a>
  </div>
</div>

<script>
const CSV_URL = 'data.csv?v=' + Date.now();
const grid = document.getElementById('cards');
const tabs = document.querySelectorAll('.tab');

const PHONE_PLAN = {
  SK: 'SK 109ìš”ê¸ˆ 6ê°œì›”',
  KT: 'KT 110ìš”ê¸ˆ 6ê°œì›”',
  LG: 'LG 115ìš”ê¸ˆ 6ê°œì›”'
};
const PHONE_EXTRA = 'ë¶€ê°€ë³„ë„ë¬¸ì˜';

function parseCSV(text){
  const t = (text || '').replace(/\r/g,'');
  const rows=[], cur=[];
  let cell='', inQ=false;
  for(let i=0;i<t.length;i++){
    const c=t[i], n=t[i+1];
    if(c === '"' && n === '"'){ cell+='"'; i++; }
    else if(c === '"'){ inQ = !inQ; }
    else if(c === ',' && !inQ){ cur.push(cell); cell=''; }
    else if(c === '\n' && !inQ){
      cur.push(cell); rows.push([...cur]);
      cur.length=0; cell='';
    } else cell += c;
  }
  cur.push(cell); rows.push([...cur]);
  if(!rows.length) return [];
  const header = rows.shift().map(h => (h||'').trim());
  return rows.filter(r => r.some(v => (v||'').trim() !== '')).map(r=>{
    const o={}; header.forEach((h,i)=> o[h]=(r[i]??'').trim()); return o;
  });
}

function phonePrice(nStr){
  const n = Number(String(nStr||'').replace(/,/g,'').trim());
  if(!isFinite(n) || n <= 0) return 'ë¬¸ì˜';
  return `${n}ë§Œì›`;
}

function phoneCards(r){
  const out=[];
  const m = (r.display_price||'').match(/ì´ë™\s*([-\d.,]+)/);
  const g = (r.display_price||'').match(/ê¸°ë³€\s*([-\d.,]+)/);
  const plan = PHONE_PLAN[r.carrier] || '';
  if(m){
    out.push(`
      <div class="card phone">
        <div class="badge">ì´ë™</div>
        <div class="model">${escapeHTML(r.title)}</div>
        <div class="price">${phonePrice(m[1])}</div>
        <div class="sub">${plan}</div>
        <div class="sub">${PHONE_EXTRA}</div>
      </div>
    `);
  }
  if(g){
    out.push(`
      <div class="card phone">
        <div class="badge">ê¸°ë³€</div>
        <div class="model">${escapeHTML(r.title)}</div>
        <div class="price">${phonePrice(g[1])}</div>
        <div class="sub">${plan}</div>
        <div class="sub">${PHONE_EXTRA}</div>
      </div>
    `);
  }
  return out;
}

/* âœ… ì €ê°€ìš”ê¸ˆí°: ì´ë™/ê¸°ë³€ ë¶„í•´ */
function parseMoveChange(text){
  const s = String(text||'').replace(/\s+/g,' ').trim();
  const m = s.match(/ì´ë™\s*([-\d.,]+)/);
  const g = s.match(/ê¸°ë³€\s*([-\d.,]+)/);
  if(m || g){
    const lines = [];
    if(m) lines.push({label:'ì´ë™', num:String(m[1]).replace(/,/g,'').trim()});
    if(g) lines.push({label:'ê¸°ë³€', num:String(g[1]).replace(/,/g,'').trim()});
    return {type:'split', lines};
  }
  return {type:'raw', raw:s};
}

/* âœ… ìˆ«ì ì¶”ì¶œ(ë°°ì§€ ìë™ì¶”ê°€ìš©) */
function lowNumsFromDisplay(display_price){
  const p = parseMoveChange(display_price);
  if(p.type !== 'split') return [];
  return p.lines
    .map(x => Number(String(x.num).replace(/,/g,'').trim()))
    .filter(n => Number.isFinite(n));
}

/* âœ… ì €ê°€ìš”ê¸ˆí° ê°€ê²© í‘œì‹œ(0/ë§ˆì´ë„ˆìŠ¤ í¬í•¨ ê·¸ëŒ€ë¡œ í‘œê¸°) */
function lowPriceHTML(display_price){
  const p = parseMoveChange(display_price);
  if(p.type === 'split'){
    const rows = p.lines.map(x=>{
      return `
        <div class="lowLine">
          <span class="lowLabel">${escapeHTML(x.label)}</span>
          <span class="lowNum">${escapeHTML(x.num)}</span>
          <span class="lowSuffix">ë§Œì›</span>
        </div>
      `;
    }).join('');
    return `<div class="lowPrice">${rows}</div>`;
  }
  const raw = p.raw || '';
  return `
    <div class="lowPrice">
      <div class="lowLine">
        <span class="lowLabel">ì¡°ê±´</span>
        <span class="lowNum">${escapeHTML(raw)}</span>
      </div>
    </div>
  `;
}

/* âœ… ì €ê°€ìš”ê¸ˆí°: 1í–‰=1ì¹´ë“œ + ë°°ì§€ ìë™ì¶”ê°€(0ì›í°/ë§ˆì´ë„ˆìŠ¤í°) */
function lowOneCard(r){
  const plan = PHONE_PLAN[r.carrier] || '';
  const carrierLabel = (r.carrier || '').toUpperCase();

  const nums = lowNumsFromDisplay(r.display_price);
  const hasMinus = nums.some(n => n < 0);
  const hasZero  = nums.some(n => n === 0);
  const extraBadge = hasMinus ? ' Â· ë§ˆì´ë„ˆìŠ¤í°' : (hasZero ? ' Â· 0ì›í°' : '');

  return `
    <div class="card phone">
      <div class="badge">${escapeHTML(carrierLabel)} Â· ì €ê°€ìš”ê¸ˆí°${escapeHTML(extraBadge)}</div>
      <div class="model">${escapeHTML(r.title)}</div>
      <div class="price">${lowPriceHTML(r.display_price)}</div>
      <div class="sub">${plan}</div>
      <div class="sub">${PHONE_EXTRA}</div>
    </div>
  `;
}

/* âœ… ì¤€ë¹„ì¤‘ ì¹´ë“œ */
function soonCard(){
  return `
    <div class="card phone card--soon">
      <div class="badge">ì¤€ë¹„ì¤‘</div>
      <div class="model"><span class="soonIcon">â³</span>ì €ê°€ìš”ê¸ˆí° ì¤€ë¹„ì¤‘</div>
      <div class="price">COMING</div>
      <div class="sub">ê³§ ì¶”ê°€ë©ë‹ˆë‹¤</div>
      <div class="sub">ì¹´í†¡ë¬¸ì˜</div>
    </div>
  `;
}

function filterRows(rows, tab){
  if(tab==='SK_PHONE') return rows.filter(r=>r.type==='PHONE' && r.carrier==='SK');
  if(tab==='KT_PHONE') return rows.filter(r=>r.type==='PHONE' && r.carrier==='KT');
  if(tab==='LG_PHONE') return rows.filter(r=>r.type==='PHONE' && r.carrier==='LG');

  // âœ… ì €ê°€ìš”ê¸ˆí°: PHONE_LOW ì „ì²´(SK/KT/LG)
  if(tab==='LOW_PHONE') return rows.filter(r=>r.type==='PHONE_LOW' && (r.carrier==='SK' || r.carrier==='KT' || r.carrier==='LG'));

  return [];
}

function render(tab){
  fetch(CSV_URL,{cache:'no-store'})
    .then(r=>r.text())
    .then(t=>{
      const rows = parseCSV(t);
      const show = filterRows(rows, tab);
      grid.innerHTML='';

      if(tab === 'LOW_PHONE'){
        // ì €ê°€ìš”ê¸ˆí°: 1í–‰=1ì¹´ë“œ
        show.forEach(r=>{ grid.innerHTML += lowOneCard(r); });

        // í•­ìƒ 6ì¹¸: ë¶€ì¡±ë¶„ ì¤€ë¹„ì¤‘ ì¹´ë“œ ì±„ì›€
        const currentCount = grid.querySelectorAll('.card').length;
        const need = Math.max(0, 6 - currentCount);
        for(let i=0;i<need;i++){ grid.innerHTML += soonCard(); }
      } else {
        // ê¸°ì¡´ íœ´ëŒ€í°(ì´ë™/ê¸°ë³€ ë¶„ë¦¬)
        show.forEach(r=>{
          phoneCards(r).forEach(h=>grid.innerHTML+=h);
        });
      }

      if(!grid.innerHTML.trim()){
        grid.innerHTML = `
          <div class="card" style="grid-column:1 / -1;">
            <div class="model">í‘œì‹œí•  í•­ëª© ì—†ìŒ</div>
            <div class="sub">data.csvì— íœ´ëŒ€í° í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</div>
          </div>
        `;
      }
    });
}

function escapeHTML(str){
  return (str ?? '').toString()
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'","&#039;");
}

tabs.forEach(t=>{
  t.onclick=()=>{
    tabs.forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    render(t.dataset.tab);
  };
});

render('SK_PHONE');
</script>

</body>
</html>
